class t{date=new Date;id=(Date.now()+"").slice(-10);constructor(t,e,s){this.coords=t,this.distance=e,this.duration=s}_setDescription(t){this.description=`${"running"===t?"\uD83C\uDFC3‍♂️":"\uD83D\uDEB4‍♀️"} ${t[0].toUpperCase()}${t.slice(1)} on ${["January","February","March","April","May","June","July","August","September","October","November","December"][this.date.getMonth()]} ${this.date.getDate()}`}}class e extends t{type="running";constructor(t,e,s,o){super(t,e,s),this.cadence=o,this.calcPace(),this._setDescription(this.type)}calcPace(){return this.pace=this.duration/this.distance,this.pace}}class s extends t{type="cycling";constructor(t,e,s,o){super(t,e,s),this.elevationGain=o,this.calcSpeed(),this._setDescription(this.type)}calcSpeed(){return this.speed=this.distance/(this.duration/60),this.speed}}const o=document.querySelector(".form"),i=document.querySelector(".workouts");document.querySelectorAll(".form__input");const a=document.querySelector(".form__input--type"),n=document.querySelector(".form__input--distance"),r=document.querySelector(".form__input--duration"),l=document.querySelector(".form__input--cadence"),u=document.querySelector(".form__input--elevation"),c=document.querySelector(".workouts__list"),d=document.querySelector(".clear__all");new class{#t;#e;#s;#o=13;#i=[];#a=[];#n=[];#r=!1;#l;constructor(){this._getLocalStorage(),this._getPosition(),this._showClearAll(),o.addEventListener("submit",this._creatingNewWorkout.bind(this)),a.addEventListener("change",this._toggleElevationField),i.addEventListener("click",this._moveToMap.bind(this)),c.addEventListener("click",this._deleteWorkout.bind(this)),c.addEventListener("click",this._editWorkout.bind(this)),d.addEventListener("click",this._clearWorkouts.bind(this)),this._indexDelegation()}_getPosition(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(this._loadMap.bind(this),function(){alert("Cannot acces your position!")})}_indexDelegation(){c.querySelectorAll(".edit__btn").forEach((t,e)=>t.addEventListener("click",(function(){this.#l=Math.abs(e-(this.#n.length-1))}).bind(this)))}_loadMap(t){let{latitude:e,longitude:s}=t.coords;this.#e=L.map("map").setView([e,s],13),L.tileLayer("https://tile.openstreetmap.fr/hot/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(this.#e),this.#e.on("click",this._showForm.bind(this)),this.#e.on("click",this._toggleEditing.bind(this,!1)),this.#e.on("click",this._clearAllSelected),this.#i.forEach(t=>this._renderWorkoutMarker(t))}_showForm(t){this.#s=t,o.classList.remove("hidden"),n.focus()}_hideForm(){o.style.display="none",o.classList.add("hidden"),n.value=r.value=l.value=u.value="",setTimeout(()=>o.style.display="grid",1e3)}_toggleElevationField(){l.closest(".form__row").classList.toggle("form__row--hidden"),u.closest(".form__row").classList.toggle("form__row--hidden")}_clearAllSelected(){document.querySelectorAll(".workout").forEach(t=>{t.classList.remove("editing__active"),t.classList.remove("selected__active")}),a.value="running",n.value=r.value=l.value=u.value="",l.closest(".form__row").classList.remove("form__row--hidden"),u.closest(".form__row").classList.add("form__row--hidden")}_toggleEditing(t){this.#r=t,a.disabled=t}_creatingNewWorkout(t){t.preventDefault(),this.#r?this._editSubmit():this._newWorkout()}_newWorkout(){let t;if(o.classList.contains("hidden"))return;let i=(...t)=>t.every(t=>Number.isFinite(t)),c=(...t)=>t.every(t=>t>=1),d=a.value,_=+n.value,h=+r.value,{lat:p,lng:v}=this.#s.latlng;if("running"===d){let s=+l.value;if(!i(_,h,s)||!c(_,h,s))return alert("Data needs to be positive numbers!");t=new e([p,v],_,h,s)}if("cycling"===d){let e=+u.value;if(!i(_,h,e)||!c(_,h))return alert("Data needs to be positive numbers!");t=new s([p,v],_,h,e)}this.#i.push(t),this._renderWorkoutMarker(t),this._renderWorkout(t),this._showClearAll(),this._setLocalStorage(),this._hideForm(),console.log(this.#i)}_renderWorkoutMarker(t){let e=L.marker(t.coords).addTo(this.#e).bindPopup(L.popup({maxWidth:250,minWidth:100,autoClose:!1,closeOnClick:!1,className:`${t.type}-popup`})).setPopupContent(t.description).openPopup();this.#a.push(e)}_renderWorkout(t){let e=`
    <li class="workout workout--${t.type}" data-id="${t.id}">
    <span class="close__btn">&times;</span>
    <span class="edit__btn">&#9998;</span>
      <h2 class="workout__title">${t.description}</h2>
        <div class="workout__details">
        
          <span class="workout__icon">${"running"===t.type?"\uD83C\uDFC3‍♂️":"\uD83D\uDEB4‍♀️"}</span>
          <span class="workout__value distance__value">${t.distance}</span>
          <span class="workout__unit">km</span>
          
        </div>
        <div class="workout__details">
          <span class="workout__icon">\u{23F1}</span>
          <span class="workout__value duration__value">${t.duration}</span>
          <span class="workout__unit">min</span>
        </div>
          `;"running"===t.type&&(e+=`
      <div class="workout__details">
        <span class="workout__icon">\u{1F9B6}\u{1F3FC}</span>
        <span class="workout__value cadence__value">${t.cadence}</span>
        <span class="workout__unit">spm</span>
      </div>
      <div class="workout__details">
        <span class="workout__icon">\u{26A1}\u{FE0F}</span>
        <span class="workout__value pace__value">${Math.trunc(t.pace)}</span>
        <span class="workout__unit">min/km</span>
      </div>
    </li>
      `),"cycling"===t.type&&(e+=`
      <div class="workout__details">
        <span class="workout__icon">\u{26F0}</span>
        <span class="workout__value elevationGain__value">${t.elevationGain}</span>
        <span class="workout__unit">m</span>
      </div>
      <div class="workout__details">
        <span class="workout__icon">\u{26A1}\u{FE0F}</span>
        <span class="workout__value speed__value">${Math.trunc(t.speed)}</span>
        <span class="workout__unit">km/h</span>
      </div>
        
    </li>
      `),this.#n.push(e),c.insertAdjacentHTML("afterbegin",e),this._indexDelegation()}_moveToMap(t){let e=t.target.closest(".workout");if(!e||t.target.closest(".edit__btn"))return;let s=this.#i.find(t=>t.id===e.dataset.id);s&&(this.#e.setView(s.coords,this.#o,{animate:!0,pan:{duration:1}}),this._hideForm(),this._clearAllSelected(),e.classList.add("selected__active"))}_deleteWorkout(t){let e=t.target.closest(".close__btn");if(!e)return;let s=this.#i.find(t=>t.id===e.closest(".workout").dataset.id);if(!s)return;let o=this.#i.findIndex(t=>t.id===s.id);this.#i.splice(o,1),this.#n.splice(o,1),c.innerHTML="",this.#n.slice().forEach(t=>{c.insertAdjacentHTML("afterbegin",t)}),this.#e.removeLayer(this.#a[o]),this.#a.splice(o,1),this._showClearAll(),this._hideForm(),this._indexDelegation(),this._setLocalStorage()}_editWorkout(t){if(!t.target.closest(".edit__btn"))return;this._clearAllSelected(),t.target.closest(".workout").classList.add("editing__active"),this._showForm(),this._toggleEditing(!0);let e=this.#n[this.#l];new DOMParser().parseFromString(e,"text/html").querySelector(".workout").classList.contains("workout--running")?(a.value="running",n.value=this.#i[this.#l].distance,r.value=this.#i[this.#l].duration,l.value=this.#i[this.#l].cadence,l.closest(".form__row").classList.remove("form__row--hidden"),u.closest(".form__row").classList.add("form__row--hidden")):(a.value="cycling",n.value=this.#i[this.#l].distance,r.value=this.#i[this.#l].duration,u.value=this.#i[this.#l].elevationGain,l.closest(".form__row").classList.add("form__row--hidden"),u.closest(".form__row").classList.remove("form__row--hidden"))}_editSubmit(){let t=this.#n[this.#l],e=this.#i[this.#l],s=new DOMParser().parseFromString(t,"text/html").querySelector(".workout"),o=(...t)=>t.every(t=>Number.isFinite(t)),i=(...t)=>t.every(t=>t>=1);if(s.querySelector(".distance__value").textContent=n.value,s.querySelector(".duration__value").textContent=r.value,s.classList.contains("workout--running")){if(!o(+n.value,+r.value,+l.value)||!i(+n.value,+r.value,+l.value))return alert("Data needs to be positive numbers!");e.distance=+n.value,e.duration=+r.value,e.cadence=+l.value;let t=Math.trunc(r.value/n.value);e.pace=t,s.querySelector(".cadence__value").textContent=l.value,s.querySelector(".pace__value").textContent=t}else{if(!o(+n.value,+r.value,+u.value)||!i(+n.value,+r.value))return alert("Data needs to be positive numbers!");e.distance=+n.value,e.duration=+r.value,e.elevationGain=+u.value;let t=Math.trunc(n.value/(r.value/60));e.speed=t,s.querySelector(".elevationGain__value").textContent=u.value,s.querySelector(".speed__value").textContent=t}this.#n[this.#l]=s.outerHTML,c.innerHTML="",this.#n.slice().forEach(t=>{c.insertAdjacentHTML("afterbegin",t)}),this._hideForm(),this._toggleEditing(!1),this._indexDelegation(),this._setLocalStorage()}_setLocalStorage(){localStorage.setItem("workouts",JSON.stringify(this.#i))}_getLocalStorage(){this.#t=JSON.parse(localStorage.getItem("workouts")),this.#t&&(this.#t.map(t=>{"running"===t.type&&Object.setPrototypeOf(t,e.prototype),"cycling"===t.type&&Object.setPrototypeOf(t,s.prototype)}),this.#i=this.#t,console.log(this.#i),this.#i.forEach(t=>this._renderWorkout(t)))}_showClearAll(){this.#i.length>=1?d.classList.remove("clear__all--hidden"):d.classList.add("clear__all--hidden")}_clearWorkouts(){localStorage.clear(),location.reload()}};
//# sourceMappingURL=index.b1d8ea29.js.map
